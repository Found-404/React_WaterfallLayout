(function(C,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],f):(C=typeof globalThis<"u"?globalThis:C||self,f(C.WaterfallReact={},C.React))})(this,function(C,f){"use strict";var b={exports:{}},W={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j;function Q(){if(j)return W;j=1;var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function s(l,r,e){var t=null;if(e!==void 0&&(t=""+e),r.key!==void 0&&(t=""+r.key),"key"in r){e={};for(var u in r)u!=="key"&&(e[u]=r[u])}else e=r;return r=e.ref,{$$typeof:n,type:l,key:t,ref:r!==void 0?r:null,props:e}}return W.Fragment=i,W.jsx=s,W.jsxs=s,W}var A;function X(){return A||(A=1,b.exports=Q()),b.exports}var R=X(),Z=(()=>{function n(e,t,u,d){let c=e.clientWidth,a=u.length,x=0,h=0;for(;h<a;){let o=i(c,t,u,h);for(let m=0,y=0,M,w;m<o.count;m++)M=u[h+m],w=d[h+m],w.top=x,w.left=o.left+y,w.width=M.width*o.height/M.height,w.height=o.height,y+=w.width;h+=o.count,x+=o.height}e.style.height=x+"px"}function i(e,t,u,d){let c=s(e,t.lineGap,u,d),a=Math.max(c-1,1),x=l(e,t,u,d,c),h=l(e,t,u,d,a),o=r(h,x,e),m=o.height,y=o.width;return o.count===1&&(y=Math.min(t.singleMaxWidth,e),m=u[d].height*y/u[d].width),{left:F(e,y,t.align),count:o.count,height:m}}function s(e,t,u,d){let c=0;for(let a=d,x=0;a<u.length&&x<=e;a++)x+=u[a].width*t/u[a].height,c++;return c}function l(e,t,u,d,c){let a=0;for(let o=c-1;o>=0;o--){let m=u[d+o];a+=m.width*t.lineGap/m.height}let x=t.lineGap*e/a;if(x<=t.maxLineGap&&x>=t.minLineGap)return{cost:Math.abs(t.lineGap-x),count:c,width:e,height:x};{let o=a>e?t.minLineGap:t.maxLineGap;return{cost:1/0,count:c,width:a*o/t.lineGap,height:o}}}function r(e,t,u){return e.cost===1/0&&t.cost===1/0?t.width<u?t:e:t.cost>=e.cost?e:t}return{calculate:n}})(),K=(()=>{function n(l,r,e,t){let u=l.clientWidth,d=r.grow,c=d?s(u,d):i(u,r),a=P(0,c.count);e.forEach((x,h)=>{let o=a.reduce((M,w,S)=>w<a[M]?S:M,0),m=c.width[o%c.count],y=t[h];y.top=a[o],y.left=c.left+(o?$(c.width.slice(0,o)):0),y.width=m,y.height=x.height*(r.fixedHeight?1:m/x.width),a[o]=a[o]+y.height}),l.style.height=Math.max.apply(Math,a)+"px"}function i(l,r){let e=l/r.lineGap,t;if(r.singleMaxWidth>=l)e=1,t=Math.max(l,r.minLineGap);else{let u=r.maxLineGap*~~e,d=r.minLineGap*~~(e+1),c=u>=l,a=d<=l;c&&a?(e=Math.round(e),t=l/e):c?(e=~~e,t=l/e):a?(e=~~(e+1),t=l/e):(e=~~e,t=r.maxLineGap),e===1&&(t=Math.min(l,r.singleMaxWidth),t=Math.max(t,r.minLineGap))}return{width:P(t,e),count:e,left:F(l,t*e,r.align)}}function s(l,r){let e=$(r);return{width:r.map(t=>l*t/e),count:r.length,left:0}}return{calculate:n}})();function F(n,i,s){switch(s){case"right":return n-i;case"center":return(n-i)/2;default:return 0}}function P(n,i){let s=typeof n=="function"?()=>n():()=>n,l=[];for(let r=0;r<i;r++)l[r]=s();return l}function $(n){return n.reduce((i,s)=>i+s)}const O=f.createContext(),q="_wfMoveClass";function H(n,i,s,l=!1){n.addEventListener(i,s,l)}function I(n,i,s,l=!1){n.removeEventListener(i,s,l)}function J(n){let i=n.target,s=i[q];s&&ee(i,s)}function ee(n,i){let s=new RegExp("\\s*\\b"+i+"\\b\\s*","g"),l=T(n,"class").replace(s," ").trim();T(n,"class",l)}function T(n,i,s){if(typeof s<"u")n.setAttribute(i,s);else return n.getAttribute(i)||""}function N(){return window.ontransitionend===void 0&&window.onwebkittransitionend!==void 0?"webkitTransitionEnd":"transitionend"}function te(n,i){return i!==n.clientWidth}function ne(n,i,s){let l=i.left-s.left,r=i.top-s.top,e=i.width/s.width,t=i.height/s.height;n.style.transform=n.style.WebkitTransform=`translate(${l}px,${r}px) scale(${e},${t})`,n.style.transitionDuration="0s"}function re(n,i){if(!ie(n,i)){let l=(T(n,"class").trim()+" "+i).trim();T(n,"class",l)}}function ie(n,i){return new RegExp("\\b"+i+"\\b").test(T(n,"class"))}function le(n){n.style.transform=n.style.WebkitTransform="",n.style.transitionDuration=""}function V(n){const{autoResize:i=!0,interval:s=200,align:l="left",line:r="v",lineGap:e=200,minLineGap:t,maxLineGap:u,singleMaxWidth:d,grow:c,fixedHeight:a=!1,watch:x={}}=n,h=f.useRef(null),o=f.useRef([]),m=f.useRef([]),[y,M]=f.useState([]),w=f.useCallback(()=>{if(!h.current)return;let p=h.current.clientWidth;M(()=>{const v=Array.from(o.current).map(g=>g.getMeta());return v.sort((g,G)=>g.order-G.order),m.current=v.map(()=>({})),Y(h.current,v,m.current),setTimeout(()=>{te(h.current,p)&&Y(h.current,v,m.current),console.log(m.current),h.current.style.overflow="hidden",S(m.current,v)},0),v})},[r,l,e,t,u,d,a,c]);function S(p,v){let g=v.filter(E=>E.moveClass),G=B(g);ue(p,v);let L=B(g);g.forEach((E,U)=>{E.node.current[q]=E.moveClass,ne(E.node.current,G[U],L[U])}),g.forEach(E=>{re(E.node.current,E.moveClass),le(E.node.current)})}function ue(p,v){p.forEach((g,G)=>{let L=v[G].node.current.style;o.current[G].setRect(g);for(let E in g)L[E]=g[E]+"px"})}function B(p){return p.map((v,g)=>o.current[g].getRect())}const D=f.useRef(null),k=f.useRef(w);f.useEffect(()=>{k.current=w},[w]);const _=f.useCallback(()=>{clearTimeout(D.current),D.current=setTimeout(()=>{k.current&&k.current()},s)},[s]);f.useEffect(()=>(i&&H(window,"resize",_,!1),h.current&&H(h.current,N(),J,!0),()=>{I(window,"resize",_,!1),h.current&&I(h.current,N(),J,!0)}),[i,_]);function oe(){const p=u?+u:e;return console.log(c),{align:~["left","right","center"].indexOf(l)?l:"left",line:~["v","h"].indexOf(r)?r:"v",lineGap:+e,minLineGap:t?+t:e,maxLineGap:p,singleMaxWidth:Math.max(d||0,u),fixedHeight:!!a,grow:c&&c.map(v=>+v)}}function Y(p,v,g){let G=oe();(r==="h"?Z:K).calculate(p,G,v,g)}const ae=f.useMemo(()=>n.children,[n.children]);f.useEffect(()=>{w()},[ae]);const fe=f.Children.map(n.children,(p,v)=>f.cloneElement(p,{ref:g=>{typeof p.ref=="function"?p.ref(g):p.ref&&typeof p.ref!="function"&&(p.ref.current=g),o.current[v]=g}})),ce=f.useMemo(()=>({reflow:w}),[w]);return R.jsx("div",{className:"waterfall",ref:h,children:R.jsx(O.Provider,{value:ce,children:fe})})}const z=f.forwardRef((n,i)=>{const{width:s,height:l,order:r,moveClass:e}=n,t=f.useRef(),[u,d]=f.useState({top:0,left:0,width:0,height:0,order:r}),[c,a]=f.useState(!1);f.useContext(O);const x=()=>({vm:t,node:t,order:r,width:s,height:l,moveClass:e}),h=()=>{a(!0)};return f.useEffect(()=>{h()},[]),f.useImperativeHandle(i,()=>({getMeta:x,getRect:()=>u,setRect:o=>d(o)})),R.jsx("div",{className:"waterfall-slot",ref:t,style:{visibility:c?"visible":"hidden"},children:n.children})}),se={Waterfall:V,WaterfallSlot:z};C.Waterfall=V,C.WaterfallSlot=z,C.default=se,Object.defineProperties(C,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
